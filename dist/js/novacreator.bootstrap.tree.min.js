/*! 
 * Nova Creator Bootstrap Tree v1.0.0 - 11/07/2016
 * Copyright (c) 2015-2016 Nova Creator Software (https://github.com/NovaCreatorSoftware/bootstrap-tree)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
!function(a,b,c){/*jshint validthis: true */
"use strict";!function(a){a.event.special.novadoubletap={bindType:"touchend",delegateType:"touchend",handle:function(a){var b=a.handleObj,c=jQuery.data(a.target),d=(new Date).getTime(),e=c.lastTouch?d-c.lastTouch:0,f=null==f?300:f;e<f&&e>30?(c.lastTouch=null,a.type=b.origType,["clientX","clientY","pageX","pageY"].forEach(function(b){a[b]=a.originalEvent.changedTouches[0][b]}),
//let jQuery handle the triggering of "doubletap" event handlers
b.handler.apply(this,arguments)):c.lastTouch=d}},a.fn.treely=function(c){var d={selectable:!0,deletable:!1,editable:!1,addable:!1,doOnDoubleTap:function(){b.alert("novadoubletap dblclick")},i18n:{deleteNull:"Delete null",deleteConfirmation:"Are you sure you want to delete?",confirmButtonLabel:"Confirm",editNull:"Edit null",editMultiple:"Edit multiple",addMultiple:"Add multiple",collapseTip:"Collapse",expandTip:"Expand",selectTip:"Select",unselectTip:"Deselect",editTip:"Edit",addTip:"Add",deleteTip:"Delete",cancelButtonLabel:"Cancel"}},e=a('<div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong></strong><span class="alert-content"></span> </div> '),f=a('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong></strong><span class="alert-content"></span> </div> '),g=a('<div class="input-group"><input type="text" class="form-control"><span class="input-group-btn"><button type="button" class="btn btn-default btn-success confirm"></button> </span><span class="input-group-btn"><button type="button" class="btn btn-default cancel"></button> </span> </div> ');c=a.extend(d,c),this.each(function(){var b=a(this),d=function(){return a(b).find("li.li_selected")};a.each(a(b).find("ul > li"),function(){var b;if(a(this).is("li:has(ul)")){var c=a(this).find(" > ul");a(c).remove(),b=a(this).text(),a(this).html('<span><span class="glyphicon"></span><a href="javascript: void(0);"></a> </span>'),a(this).find(" > span > span").addClass("glyphicon-folder-open"),a(this).find(" > span > a").text(b),a(this).append(c)}else b=a(this).text(),a(this).html('<span><span class="glyphicon"></span><a href="javascript: void(0);"></a> </span>'),a(this).find(" > span > span").addClass("glyphicon-file"),a(this).find(" > span > a").text(b)}),a(b).find("li:has(ul)").addClass("parent_li").find(" > span").attr("title",c.i18n.collapseTip),(c.deletable||c.editable||c.addable)&&a(b).prepend('<div class="treely-toolbar"></div> '),c.addable&&(a(b).find(".treely-toolbar").append('<div class="create"><button class="btn btn-default btn-sm btn-success"><span class="glyphicon glyphicon-plus"></span></button></div> '),a(b).find(".treely-toolbar .create > button").attr("title",c.i18n.addTip).on("click touchstart",function(){var f=a(b).find(".treely-toolbar .create");a(f).append(g),a(g).find("input").focus(),a(g).find(".confirm").text(c.i18n.confirmButtonLabel),a(g).find(".confirm").on("click touchstart",function(){if(""!==a(g).find("input").val()){var f=d(),h=a('<li><span><span class="glyphicon glyphicon-file"></span><a href="javascript: void(0);">'+a(g).find("input").val()+"</a> </span></li>");a(h).find(" > span > span").attr("title",c.i18n.collapseTip),a(h).find(" > span > a").attr("title",c.i18n.selectTip),f.length<=0?a(b).find(" > ul").append(a(h)):f.length>1?(a(b).prepend(e),a(b).find(".alert .alert-content").text(c.i18n.addMultiple)):a(f).hasClass("parent_li")?a(f).find(" > ul").append(h):(a(f).addClass("parent_li").find(" > span > span").addClass("glyphicon-folder-open").removeClass("glyphicon-file"),a(f).append(a("<ul></ul>")).find(" > ul").append(h)),a(g).find("input").val(""),c.selectable&&(a(h).find(" > span > a").attr("title",c.i18n.selectTip),a(h).find(" > span > a").on("click touchstart",function(e){var f=a(this).parent().parent();if(f.hasClass("li_selected")?(a(this).attr("title",c.i18n.selectTip),a(f).removeClass("li_selected")):(a(b).find("li.li_selected").removeClass("li_selected"),a(this).attr("title",c.i18n.unselectTip),a(f).addClass("li_selected")),c.deletable||c.editable||c.addable){var g=d();c.editable&&(g.length<=0||g.length>1?a(b).find(".treely-toolbar .edit > button").addClass("disabled"):a(b).find(".treely-toolbar .edit > button").removeClass("disabled")),c.deletable&&(g.length<=0||g.length>1?a(b).find(".treely-toolbar .remove > button").addClass("disabled"):a(b).find(".treely-toolbar .remove > button").removeClass("disabled"))}e.stopPropagation()})),a(g).remove()}}),a(g).find(".cancel").text(c.i18n.cancelButtonLabel),a(g).find(".cancel").on("click touchstart",function(){a(g).remove()})})),c.editable&&(a(b).find(".treely-toolbar").append('<div class="edit"><button class="btn btn-default btn-sm btn-primary disabled"><span class="glyphicon glyphicon-edit"></span></button></div> '),a(b).find(".treely-toolbar .edit > button").attr("title",c.i18n.editTip).on("click touchstart",function(){a(b).find("input.treely-editor").remove(),a(b).find("li > span > a:hidden").show();var f=d();if(f.length<=0)a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.editNull);else if(f.length>1)a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.editMultiple);else{var g=a(f).find(" > span > a").text();g=g&&g.trim(),a(f).find(" > span > a").hide(),a(f).find(" > span").append('<input type="text" class="treely-editor">');var h=a(f).find(" > span > input.treely-editor");a(h).val(g),a(h).focus(),a(h).keydown(function(b){13===b.which?//enter
""!==a(h).val()&&(a(f).find(" > span > a").text(a(h).val()),a(h).remove(),a(f).find(" > span > a").show()):27===b.which&&(//escape
a(h).remove(),a(f).find(" > span > a").show())})}})),c.deletable&&(a(b).find(".treely-toolbar").append('<div class="remove"><button class="btn btn-default btn-sm btn-danger disabled"><span class="glyphicon glyphicon-remove"></span></button></div> '),a(b).find(".treely-toolbar .remove > button").attr("title",c.i18n.deleteTip).on("click touchstart",function(){var g=d();g.length<=0?(a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.deleteNull)):(a(b).prepend(f),a(b).find(".alert .alert-content").html(c.i18n.deleteConfirmation).append('<a style="margin-left: 10px;" class="btn btn-default btn-danger confirm"></a>').find(".confirm").html(c.i18n.confirmButtonLabel),a(b).find(".alert .alert-content .confirm").on("click touchstart",function(){a(g).find("ul").remove(),a(g).parent("ul").find(" > li").length<=1&&(a(g).parents("li").removeClass("parent_li").find(" > span > span").removeClass("glyphicon-folder-open").addClass("glyphicon-file"),a(g).parent("ul").remove()),a(g).remove(),a(f).remove()}))})),
//collapse or expand
a(b).on("click touchstart","li.parent_li > span",function(b){var d=a(this).parent("li.parent_li").find(" > ul > li");d.is(":visible")?(d.hide("fast"),a(this).attr("title",c.i18n.expandTip).find(" > span.glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open")):(d.show("fast"),a(this).attr("title",c.i18n.collapseTip).find(" > span.glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close")),b.stopPropagation()}),c.selectable&&(a(b).find("li > span > a").attr("title",c.i18n.selectTip),a(b).find("li > span > a").on("click touchstart",function(e){var f=a(this).parent().parent();if(f.hasClass("li_selected")?(a(this).attr("title",c.i18n.selectTip),a(f).removeClass("li_selected")):(a(b).find("li.li_selected").removeClass("li_selected"),a(this).attr("title",c.i18n.unselectTip),a(f).addClass("li_selected")),c.deletable||c.editable||c.addable){var g=d();c.editable&&(g.length<=0||g.length>1?a(b).find(".treely-toolbar .edit > button").addClass("disabled"):a(b).find(".treely-toolbar .edit > button").removeClass("disabled")),c.deletable&&(g.length<=0||g.length>1?a(b).find(".treely-toolbar .remove > button").addClass("disabled"):a(b).find(".treely-toolbar .remove > button").removeClass("disabled"))}e.stopPropagation()})),a(b).find("li > span").on("novadoubletap dblclick",function(a){c.doOnDoubleTap.call(this,arguments),a.stopPropagation()})})}}(jQuery)}(jQuery,window);