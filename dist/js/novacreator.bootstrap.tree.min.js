/*! 
 * Nova Creator Bootstrap Tree v1.0.0 - 11/08/2016
 * Copyright (c) 2015-2016 Nova Creator Software (https://github.com/NovaCreatorSoftware/bootstrap-tree)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
!function(a,b,c){/*jshint validthis: true */
"use strict";/*jshint esversion: 6 */
!function(a){a.event.special.novadoubletap={bindType:"touchend",delegateType:"touchend",handle:function(a){var b=a.handleObj,c=jQuery.data(a.target),d=(new Date).getTime(),e=c.lastTouch?d-c.lastTouch:0,f=null==f?300:f;e<f&&e>30?(c.lastTouch=null,a.type=b.origType,["clientX","clientY","pageX","pageY"].forEach(function(b){a[b]=a.originalEvent.changedTouches[0][b]}),
//let jQuery handle the triggering of "doubletap" event handlers
b.handler.apply(this,arguments)):c.lastTouch=d}},a.fn.treely=function(c){var d={selectable:!0,deletable:!1,editable:!1,addable:!1,dynamicContent:!0,doOnDoubleTap:function(){b.alert("novadoubletap dblclick")},getData:function(a,b){a.call(this,[])},i18n:{deleteNull:"Delete null",deleteConfirmation:"Are you sure you want to delete?",confirmButtonLabel:"Confirm",editNull:"Edit null",editMultiple:"Edit multiple",addMultiple:"Add multiple",collapseTip:"Click to Collapse",expandTip:"Click to Expand",selectTip:"Select",unselectTip:"Deselect",editTip:"Edit",addTip:"Add",deleteTip:"Delete",cancelButtonLabel:"Cancel"}},e=a('<div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong></strong><span class="alert-content"></span> </div> '),f=a('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong></strong><span class="alert-content"></span> </div> '),g=a('<div class="input-group"><input type="text" class="form-control"><span class="input-group-btn"><button type="button" class="btn btn-default btn-success confirm"></button> </span><span class="input-group-btn"><button type="button" class="btn btn-default cancel"></button> </span> </div> ');c=a.extend(d,c);var h=function(b){var d="<li "+("folder"===b.type?"class='parent_li' ":"")+"data-id='"+b.id+"' data-type='"+b.type+"'><span"+("folder"===b.type?' title="'+c.i18n.collapseTip+'"':"")+'><span class="glyphicon '+("folder"===b.type?"glyphicon-folder-open":"glyphicon-file")+'"></span><a href="javascript: void(0);"> '+b.name+"</a></span>";return"folder"===b.type&&(d+="<ul>",b.items&&b.items.length>0&&a.each(b.items,function(a,b){d+=h(b)}),d+="</ul>"),d+="</li>"},i=function(a){return a.find("li.li_selected")};this.each(function(){var b=a(this);(c.deletable||c.editable||c.addable)&&b.append('<div class="treely-toolbar"></div><div class="padding"></div>'),c.getData(function(c){a.each(c,function(a,c){b.append("<ul>"+h(c)+"</ul>")})}),c.addable&&(a(b).find(".treely-toolbar").append('<div class="create"><button class="btn btn-default btn-sm btn-success"><span class="glyphicon glyphicon-plus"></span></button></div> '),a(b).find(".treely-toolbar .create > button").attr("title",c.i18n.addTip).on("click touchstart",function(){var d=a(b).find(".treely-toolbar .create");a(d).append(g),a(g).find("input").focus(),a(g).find(".confirm").text(c.i18n.confirmButtonLabel),a(g).find(".confirm").on("click touchstart",function(){if(""!==a(g).find("input").val()){var d=i(a(b)),f=a('<li><span><span class="glyphicon glyphicon-file"></span><a href="javascript: void(0);">'+a(g).find("input").val()+"</a> </span></li>");a(f).find(" > span > span").attr("title",c.i18n.collapseTip),a(f).find(" > span > a").attr("title",c.i18n.selectTip),d.length<=0?(a(b).append("<ul></ul>"),a(b).find(" > ul:last").append(a(f))):d.length>1?(a(b).prepend(e),a(b).find(".alert .alert-content").text(c.i18n.addMultiple)):a(d).hasClass("parent_li")?a(d).find(" > ul").append(f):(a(d).addClass("parent_li").find(" > span > span").addClass("glyphicon-folder-open").removeClass("glyphicon-file"),a(d).append(a("<ul></ul>")).find(" > ul").append(f)),a(g).find("input").val(""),c.selectable&&(a(f).find(" > span > a").attr("title",c.i18n.selectTip),a(f).find(" > span > a").on("click touchstart",function(d){var e=a(this).parent().parent();if(e.hasClass("li_selected")?(a(this).attr("title",c.i18n.selectTip),a(e).removeClass("li_selected")):(a(b).find("li.li_selected").removeClass("li_selected"),a(this).attr("title",c.i18n.unselectTip),a(e).addClass("li_selected")),c.deletable||c.editable||c.addable){var f=i(a(b));c.editable&&(f.length<=0||f.length>1?a(b).find(".treely-toolbar .edit > button").addClass("disabled"):a(b).find(".treely-toolbar .edit > button").removeClass("disabled")),c.deletable&&(f.length<=0||f.length>1?a(b).find(".treely-toolbar .remove > button").addClass("disabled"):a(b).find(".treely-toolbar .remove > button").removeClass("disabled"))}d.stopPropagation()})),a(g).remove()}}),a(g).find(".cancel").text(c.i18n.cancelButtonLabel),a(g).find(".cancel").on("click touchstart",function(){a(g).remove()})})),c.editable&&(a(b).find(".treely-toolbar").append('<div class="edit"><button class="btn btn-default btn-sm btn-primary disabled"><span class="glyphicon glyphicon-edit"></span></button></div> '),a(b).find(".treely-toolbar .edit > button").attr("title",c.i18n.editTip).on("click touchstart",function(){a(b).find("input.treely-editor").remove(),a(b).find("li > span > a:hidden").show();var d=i(a(b));if(d.length<=0)a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.editNull);else if(d.length>1)a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.editMultiple);else{var f=a(d).find(" > span > a").text();f=f&&f.trim(),a(d).find(" > span > a").hide(),a(d).find(" > span").append('<input type="text" class="treely-editor">');var g=a(d).find(" > span > input.treely-editor");a(g).val(f),a(g).focus(),a(g).keydown(function(b){13===b.which?//enter
""!==a(g).val()&&(a(d).find(" > span > a").text(a(g).val()),a(g).remove(),a(d).find(" > span > a").show()):27===b.which&&(//escape
a(g).remove(),a(d).find(" > span > a").show())})}})),c.deletable&&(a(b).find(".treely-toolbar").append('<div class="remove"><button class="btn btn-default btn-sm btn-danger disabled"><span class="glyphicon glyphicon-remove"></span></button></div> '),a(b).find(".treely-toolbar .remove > button").attr("title",c.i18n.deleteTip).on("click touchstart",function(){var d=i(a(b));d.length<=0?(a(b).prepend(e),a(b).find(".alert .alert-content").html(c.i18n.deleteNull)):(a(b).prepend(f),a(b).find(".alert .alert-content").html(c.i18n.deleteConfirmation).append('<a style="margin-left: 10px;" class="btn btn-default btn-danger confirm"></a>').find(".confirm").html(c.i18n.confirmButtonLabel),a(b).find(".alert .alert-content .confirm").on("click touchstart",function(){a(d).find("ul").remove(),a(d).parent("ul").find(" > li").length<=1&&(a(d).parents("li").removeClass("parent_li").find(" > span > span").removeClass("glyphicon-folder-open").addClass("glyphicon-file"),a(d).parent("ul").remove()),a(d).remove(),a(f).remove()}))})),
//collapse or expand
a(b).on("click touchstart","li.parent_li > span",function(b){var d=a(this).parent("li.parent_li").find(" > ul > li");if(d.length>0){if(d.is(":visible"))d.hide("fast"),c.dynamicContent&&d.remove(),a(this).attr("title",c.i18n.expandTip).find(" > span.glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open");else if(d.show("fast"),a(this).attr("title",c.i18n.collapseTip).find(" > span.glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close"),c.dynamicContent){var e=d.parent();c.getData(function(b){a.each(b,function(a,b){e.append("<ul>"+h(b)+"</ul>")})},e.data("id"))}}else if(a(this).find(" > span.glyphicon").hasClass("glyphicon-folder-close")){if(c.dynamicContent){var f=a(this).parent("li.parent_li");c.getData(function(b){a.each(b,function(a,b){f.append("<ul>"+h(b)+"</ul>")})},f.data("id"))}a(this).attr("title",c.i18n.collapseTip).find(" > span.glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close")}else a(this).attr("title",c.i18n.expandTip).find(" > span.glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open");b.stopPropagation()}),c.selectable&&(a(b).find("li > span > a").attr("title",c.i18n.selectTip),a(b).find("li > span > a").on("click touchstart",function(d){var e=a(this).parent().parent();if(e.hasClass("li_selected")?(a(this).attr("title",c.i18n.selectTip),a(e).removeClass("li_selected")):(a(b).find("li.li_selected").removeClass("li_selected"),a(this).attr("title",c.i18n.unselectTip),a(e).addClass("li_selected")),c.deletable||c.editable||c.addable){var f=i(a(b));c.editable&&(f.length<=0||f.length>1?a(b).find(".treely-toolbar .edit > button").addClass("disabled"):a(b).find(".treely-toolbar .edit > button").removeClass("disabled")),c.deletable&&(f.length<=0||f.length>1?a(b).find(".treely-toolbar .remove > button").addClass("disabled"):a(b).find(".treely-toolbar .remove > button").removeClass("disabled"))}d.stopPropagation()})),a(b).find("li > span").on("novadoubletap dblclick",function(a){c.doOnDoubleTap.call(this,arguments),a.stopPropagation()})})}}(jQuery)}(jQuery,window);